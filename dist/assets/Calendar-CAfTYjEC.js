import{j as e,A as t}from"./index-D8tfEXww.js";import{i as s,a,b as o,F as r}from"./calendar-vendor-VSl4A5Hz.js";import{h as i,r as n}from"./react-vendor-DeomjPLV.js";import{t as l}from"./utils-vendor-BfJFlMXP.js";import{u as d,C as c}from"./useCalendarEvents-DI8zlLRx.js";import{y as m}from"./ui-vendor-DBpOLB1z.js";function v(){var v;const u=i(),[f,x]=n.useState(!1),[h,p]=n.useState(void 0),b=n.useRef(null),{events:j,loading:g,error:w,loadData:C}=d(),y=n.useMemo(()=>({...c,plugins:[s,a,o],initialView:"timeGridWeek"}),[]);n.useEffect(()=>{var e;if((null==(e=u.state)?void 0:e.selectedDate)&&b.current){const e=new Date(u.state.selectedDate);b.current.getApi().gotoDate(e)}},[null==(v=u.state)?void 0:v.selectedDate]);const N=n.useCallback(()=>{p(void 0),x(!0)},[]),k=n.useCallback(e=>{const t=j.find(t=>t.id===e.event.id);t&&(p({id:t.id,profissionalId:t.profissionalId,pacienteId:t.pacienteId,tipo:t.tipo,inicio:new Date(t.start),fim:new Date(t.end),observacoes:t.observacoes}),x(!0))},[j]),D=n.useCallback(async()=>{await C(),x(!1)},[C]),A=n.useCallback(()=>{x(!1),p(void 0)},[]),E=n.useCallback(e=>{l(e.el,{content:e.event.extendedProps.tooltip,placement:"top",arrow:!0,theme:"light",allowHTML:!0})},[]),G=n.useCallback(t=>{const s=t.event.extendedProps.icon??"ðŸ“Œ",[a,o]=t.event.title.split(" - ");return e.jsxs("div",{className:"h-full w-full px-2 py-1 rounded border-l-4 text-xs leading-tight overflow-hidden shadow-sm",style:{backgroundColor:t.event.backgroundColor??"#f3f4f6",borderLeftColor:t.event.borderColor??"#3b82f6",color:t.event.textColor??"#111827"},children:[e.jsxs("div",{className:"font-semibold truncate flex items-center gap-1",children:[s," ",a]}),e.jsx("div",{className:"text-[11px] text-gray-700 truncate",children:o})]})},[]);return g?e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-12rem)]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):w?e.jsxs("div",{className:"flex items-center justify-center h-[calc(100vh-12rem)] text-red-500",children:["Erro ao carregar dados: ",w.message]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsx(r,{ref:b,...y,events:j,eventDidMount:E,eventContent:G,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},dateClick:N,eventClick:k}),e.jsx(m,{open:f,onClose:A,className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30"}),e.jsx("div",{className:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx(m.Title,{className:"text-lg font-semibold text-gray-900 mb-4",children:h?"Editar Atendimento":"Novo Atendimento"}),e.jsx(t,{atendimento:h,onSave:D,onCancel:A})]})})]})})]})}export{v as Calendar};
